package io;

import java.io.IOException;
import java.lang.Exception;
import java.nio.file.attribute.BasicFileAttributes;
import java.nio.file.FileVisitResult;
import java.nio.file.Path;
import java.nio.file.SimpleFileVisitor;

import org.apache.log4j.Logger;

public class ReportDirectorySimpleFileVisitor extends SimpleFileVisitor<Path> {

	static Logger objLogger = Logger.getLogger(ReportDirectorySimpleFileVisitor.class.getName());
	private boolean bolEntrySummaryFile;
	private Path objEntrySummaryFilePath;
	private boolean bolExlSummaryFile;
	private Path objExlSummaryFilePath;	
	private boolean bolExperimentSummaryFile;
	private Path objExperimentFilePath;		
	private boolean bolLocSummaryFile;
	private Path objLocSummaryFilePath;	
	
	public ReportDirectorySimpleFileVisitor() throws Exception {
		this.bolEntrySummaryFile = false;
		this.bolExlSummaryFile = false;
		this.bolExperimentSummaryFile = false;
		this.bolLocSummaryFile = false;
	}

	@Override public FileVisitResult visitFile(Path objInFilePath,
                                               BasicFileAttributes objInBasicFileAttributes) throws IOException {
		String strFilePath;
		String[] strArrayLineParts;
		String strFileName;
		
		System.out.println("Visiting the file: " + objInFilePath + "...");
		strFilePath = objInFilePath.toString();
		strArrayLineParts = strFilePath.split("\\/");
		strFileName = strArrayLineParts[strArrayLineParts.length - 1];
		switch (strFileName) {
		
			case "entrySummary.txt":
				try {
					if (this.bolEntrySummaryFile == false) {
						System.out.println("entrySummary detected...");
						this.bolEntrySummaryFile = true;
						this.objEntrySummaryFilePath = objInFilePath;
					}
					else {
						System.err.println("A repetition of entrySummary detected...");
						throw new Exception(); 
					}
				}
				catch (Exception e) {
					objLogger.error("ReportDirectorySimpleFileVisitor.FileVisitResult", 
			                        e);					
				}
				break;
				
			case "exlSummary.txt":
				try {
					if (this.bolExlSummaryFile == false) {
						System.out.println("exlSummary detected...");
						this.bolExlSummaryFile = true;
						this.objExlSummaryFilePath = objInFilePath;
					}
					else {
						System.err.println("A repetition of exlSummary detected...");
						throw new Exception(); 
					}
				}
				catch (Exception e) {
					objLogger.error("ReportDirectorySimpleFileVisitor.FileVisitResult", 
			                        e);					
				}
				break;
				
			case "experimentSummary.txt":
				try {
					if (this.bolExperimentSummaryFile == false) {
						System.out.println("experimentSummary detected...");
						this.bolExperimentSummaryFile = true;
						this.objExperimentFilePath = objInFilePath;
					}
					else {
						System.err.println("A repetition of experimentSummary detected...");
						throw new Exception(); 
					}
				}
				catch (Exception e) {
					objLogger.error("ReportDirectorySimpleFileVisitor.FileVisitResult", 
	                        		e);					
				}				
				break;
				
			case "locSummary.txt":
				try {
					if (this.bolLocSummaryFile == false) {
						System.out.println("locSummary detected...");
						this.bolLocSummaryFile = true;
						this.objLocSummaryFilePath = objInFilePath;
					}
					else {
						System.err.println("A repetition of locSummary detected...");
						throw new Exception(); 
					}
				}	
				catch (Exception e) {
					objLogger.error("ReportDirectorySimpleFileVisitor.FileVisitResult", 
	                        		e);					
				}				
				break;
		}
		
		return FileVisitResult.CONTINUE;
	}
	
	@Override public FileVisitResult preVisitDirectory(Path objInDirectoryPath,
                                                       BasicFileAttributes objInBasicFileAttributes)  throws IOException {
		//System.out.println("Visiting the directory: " + objInDirectoryPath + "...");

		return FileVisitResult.CONTINUE;
	}

	public boolean checkEntrySummaryFile() {
		return this.bolEntrySummaryFile;
	}
	
	public Path getEntrySummaryFilePath() {
		return this.objEntrySummaryFilePath;
	}

	public boolean checkExlSummaryFile() {
		return this.bolExlSummaryFile;
	}
	
	public Path getExlSummaryFilePath() {
		return this.objExlSummaryFilePath;
	}
	
	public boolean checkExperimentSummaryFile() {
		return this.bolExperimentSummaryFile;
	}
	
	public Path getExperimentSummaryFilePath() {
		return this.objExperimentFilePath;
	}

	public boolean checkLocSummaryFile() {
		return this.bolLocSummaryFile;
	}
	
	public Path getLocSummaryFilePath() {
		return this.objLocSummaryFilePath;
	}
}
