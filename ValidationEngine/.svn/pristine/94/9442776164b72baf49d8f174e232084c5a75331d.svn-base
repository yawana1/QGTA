package io;

import java.io.IOException;
import java.lang.Exception;
import java.nio.file.attribute.BasicFileAttributes;
import java.nio.file.FileVisitResult;
import java.nio.file.Path;
import java.nio.file.SimpleFileVisitor;
import java.util.HashMap;
import java.util.Map;

import org.apache.log4j.Logger;

import io.ModelXMLFileParser;

public class ModelDirectorySimpleFileVisitor extends SimpleFileVisitor<Path> {

	static Logger objLogger = Logger.getLogger(ModelDirectorySimpleFileVisitor.class.getName());
	private Map<String,String> objMapCrop;
	
	public ModelDirectorySimpleFileVisitor() throws Exception {
		this.objMapCrop = new HashMap<String,String>();
	}
	
	@Override public FileVisitResult visitFile(Path objInFilePath,
                                               BasicFileAttributes objInBasicFileAttributes) throws IOException {
		String strFilePath;
		ModelXMLFileParser objModelXMLFileParser;

		strFilePath = objInFilePath.toString();
		if (strFilePath.endsWith(".xml")) {
			objModelXMLFileParser =  new ModelXMLFileParser(objInFilePath);
			for (String strExperimentName : objModelXMLFileParser.getExperimentNames()) {
				this.objMapCrop.put(strExperimentName,
						            objModelXMLFileParser.getCropName());
			}
		}

		return FileVisitResult.CONTINUE;
	}
	
	public Map<String,String> getCrops() {
		return this.objMapCrop;
	} 
}
